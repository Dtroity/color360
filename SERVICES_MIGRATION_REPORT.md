# –û—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏: –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —É—Å–ª—É–≥ –º–æ–Ω—Ç–∞–∂–∞

## –î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 2025-01-27

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Entity InstallationService

**–§–∞–π–ª:** `apps/backend/src/modules/services/entities/installation-service.entity.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ –ø–æ–ª–µ `name` ‚Üí `title`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω enum `PriceType` (FIXED, PER_UNIT)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `priceType` (enum)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `unitName` (–µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `minQuantity` (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –ø–æ–ª—è `type`, `pricePerUnit`, `currency` (–Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è –ø–æ –¢–ó)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ entity:**
```typescript
- id: number
- title: string (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ)
- description: string | null
- basePrice: number (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ)
- priceType: PriceType (FIXED | PER_UNIT)
- unitName: string | null
- minQuantity: number | null (default: 1)
- isActive: boolean (default: true)
- sortOrder: number (default: 0)
- createdAt: Date
- updatedAt: Date
```

---

### 2. –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `apps/backend/src/database/migrations/1738000000001-CreateInstallationServices.ts`

**–°–æ–∑–¥–∞–Ω–æ:**
- ‚úÖ Enum `price_type_enum` —Å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ 'fixed' –∏ 'per_unit'
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `installation_services` —Å–æ –≤—Å–µ–º–∏ —Ç—Ä–µ–±—É–µ–º—ã–º–∏ –ø–æ–ª—è–º–∏
- ‚úÖ –ò–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥
- ‚úÖ –ú–µ—Ç–æ–¥—ã `up()` –∏ `down()` –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏ –æ—Ç–∫–∞—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:**
```sql
CREATE TABLE installation_services (
  id SERIAL PRIMARY KEY,
  title VARCHAR(255) NOT NULL,
  description TEXT,
  base_price NUMERIC(10, 2) NOT NULL,
  price_type price_type_enum NOT NULL DEFAULT 'fixed',
  unit_name VARCHAR(50),
  min_quantity INT DEFAULT 1,
  is_active BOOLEAN NOT NULL DEFAULT TRUE,
  sort_order INT NOT NULL DEFAULT 0,
  created_at TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP
);
```

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –º–∏–≥—Ä–∞—Ü–∏–∏:**
```bash
# –í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ apps/backend
cd apps/backend

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
npm run migration:run

# –ò–ª–∏ —á–µ—Ä–µ–∑ TypeORM CLI
npx typeorm-ts-node-commonjs migration:run -d src/config/typeorm.datasource.ts

# –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
npm run migration:revert
```

---

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Backend API

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- ‚úÖ `apps/backend/src/modules/services/services.service.ts` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞
- ‚úÖ `apps/backend/src/modules/services/admin-services.controller.ts` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ `apps/backend/src/modules/services/services.controller.ts` - –ø—É–±–ª–∏—á–Ω—ã–π API
- ‚úÖ `apps/backend/src/config/database.config.ts` - –¥–æ–±–∞–≤–ª–µ–Ω InstallationService –≤ entities

**API Endpoints:**

**–ü—É–±–ª–∏—á–Ω—ã–µ:**
- `GET /api/services` - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏
- `POST /api/services/calculate` - —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å

**–ê–¥–º–∏–Ω—Å–∫–∏–µ:**
- `GET /api/admin/services` - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —É—Å–ª—É–≥–∏
- `POST /api/admin/services` - —Å–æ–∑–¥–∞—Ç—å —É—Å–ª—É–≥—É
- `PATCH /api/admin/services/:id` - –æ–±–Ω–æ–≤–∏—Ç—å —É—Å–ª—É–≥—É
- `DELETE /api/admin/services/:id` - —É–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É
- `PATCH /api/admin/services/reorder` - –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ (drag&drop)

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º
- ‚úÖ –¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å > 0
- ‚úÖ –¢–∏–ø —Ü–µ–Ω—ã –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω (fixed –∏–ª–∏ per_unit)

---

### 4. Seed-–¥–∞–Ω–Ω—ã–µ

**–§–∞–π–ª:** `apps/backend/src/database/seeds/dev.seed.ts`

**–î–æ–±–∞–≤–ª–µ–Ω–æ 8 –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —É—Å–ª—É–≥:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–º–µ—Ä—ã** - 2500 ‚ÇΩ –∑–∞ –∫–∞–º–µ—Ä—É (per_unit)
2. **–ü—Ä–æ–∫–ª–∞–¥–∫–∞ –∫–∞–±–µ–ª—è** - 150 ‚ÇΩ –∑–∞ –º–µ—Ç—Ä (per_unit)
3. **–í–æ–∑–¥—É—à–Ω–∞—è –ª–∏–Ω–∏—è** - 200 ‚ÇΩ –∑–∞ –º–µ—Ç—Ä (per_unit)
4. **–ö–∞–±–µ–ª—å-–∫–∞–Ω–∞–ª** - 180 ‚ÇΩ –∑–∞ –º–µ—Ç—Ä (per_unit)
5. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∫–∞—Ñ–∞** - 3500 ‚ÇΩ (fixed)
6. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∏–¥–µ–æ—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** - 3000 ‚ÇΩ (fixed)
7. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–ª–æ–∫–∞ –ø–∏—Ç–∞–Ω–∏—è** - 2000 ‚ÇΩ (fixed)
8. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞** - 2500 ‚ÇΩ (fixed)

**–ó–∞–ø—É—Å–∫ seed:**
```bash
cd apps/backend
npm run seed
```

---

### 5. –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —É—Å–ª—É–≥

**–§–∞–π–ª:** `apps/frontend/src/app/admin/services/page.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥ —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —É—Å–ª—É–≥–∏
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏
- ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ª—É–≥–∏ (isActive)
- ‚úÖ Drag & Drop —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞ > 0, —Ç–∏–ø —Ü–µ–Ω—ã)
- ‚úÖ –£—Å–ª–æ–≤–Ω—ã–µ –ø–æ–ª—è (unitName –∏ minQuantity –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è per_unit)

**UI –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å—Ç–∏–ª—å –∞–¥–º–∏–Ω–∫–∏
- –¢–∞–±–ª–∏—á–Ω—ã–π –≤–∏–¥ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö/–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥

**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –º–µ–Ω—é:**
- ‚úÖ –°—Å—ã–ª–∫–∞ "–£—Å–ª—É–≥–∏ –º–æ–Ω—Ç–∞–∂–∞" –≤ –±–æ–∫–æ–≤–æ–º –º–µ–Ω—é –∞–¥–º–∏–Ω–∫–∏

---

### 6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞

**–§–∞–π–ª:** `apps/frontend/src/app/(main)/calculator/page.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (title –≤–º–µ—Å—Ç–æ name, priceType –≤–º–µ—Å—Ç–æ pricePerUnit)
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —É—Å–ª—É–≥ –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
- ‚úÖ –î–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—Å–ª—É–≥ - —á–µ–∫–±–æ–∫—Å
- ‚úÖ –î–ª—è —É—Å–ª—É–≥ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É - —Å—á–µ—Ç—á–∏–∫ —Å —É—á–µ—Ç–æ–º minQuantity
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤ —Ä–∞—Å—á–µ—Ç–µ

---

## üìã –°–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

1. `apps/backend/src/database/migrations/1738000000001-CreateInstallationServices.ts` - –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
2. `apps/frontend/src/app/admin/services/page.tsx` - –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —É—Å–ª—É–≥

## üìù –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

1. `apps/backend/src/modules/services/entities/installation-service.entity.ts` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
2. `apps/backend/src/modules/services/services.service.ts` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞
3. `apps/backend/src/modules/services/admin-services.controller.ts` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
4. `apps/backend/src/config/database.config.ts` - –¥–æ–±–∞–≤–ª–µ–Ω InstallationService –≤ entities
5. `apps/backend/src/database/seeds/dev.seed.ts` - –¥–æ–±–∞–≤–ª–µ–Ω—ã seed-–¥–∞–Ω–Ω—ã–µ
6. `apps/frontend/src/app/(main)/calculator/page.tsx` - –æ–±–Ω–æ–≤–ª–µ–Ω –ø–æ–¥ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
7. `apps/frontend/src/app/admin/layout.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –≤ –º–µ–Ω—é

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
cd apps/backend
npm run migration:run
```

### –ó–∞–ø—É—Å–∫ seed:
```bash
cd apps/backend
npm run seed
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API:
```bash
# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —É—Å–ª—É–≥–∏
curl http://localhost:3001/api/services

# –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å
curl -X POST http://localhost:3001/api/services/calculate \
  -H "Content-Type: application/json" \
  -d '{"services": [{"serviceId": 1, "quantity": 2}]}'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∫–∏:
1. –û—Ç–∫—Ä—ã—Ç—å `/admin/services`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å drag&drop —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ª—É–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞:
1. –û—Ç–∫—Ä—ã—Ç—å `/calculator`
2. –í—ã–±—Ä–∞—Ç—å —É—Å–ª—É–≥–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏
4. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:**
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î —Å–æ–∑–¥–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `installation_services` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- ‚úÖ Seed-–¥–∞–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã (8 —É—Å–ª—É–≥)
- ‚úÖ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å CRUD
- ‚úÖ Drag & Drop —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –£—Å–ª—É–≥–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –±–µ–∑ –ø—Ä–∞–≤–∫–∏ –∫–æ–¥–∞
- ‚úÖ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω –ø–æ–¥ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö (backend + frontend)

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

